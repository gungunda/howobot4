# Мобильная интеграция: пакет внедрения (Этап 9)

Цель: внедрить новую мобильную CSS-архитектуру **без изменений JS/DOM** и без риска регрессий. Всё ниже — опционально-аддитивно.

---

## 1) Подключение и базовые установки

1. В `<head>` убедиться, что есть:
   ```html
   <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes">
   ```
2. Убедиться, что подключён **один** CSS-бандл со слоями `@layer reset, tokens, base, layout, components, utilities`:
   ```html
   <link rel="stylesheet" href="assets/styles.css">
   ```
3. Ничего не меняем в `html { font-size }` — оставляем по умолчанию (100%).

> Если есть другие CSS-файлы, подключаем наш *последним*, либо переносим общие стили в соответствующие `@layer` со слабой специфичностью (см. структуру в `assets/styles.css`).

---

## 2) Карта соответствия: что «где применять» (без изменения DOM)
Ниже — «пакет классов», который можно навесить **на существующие элементы**, не переписывая разметку.

### Шапка/навигация
- Контейнер шапки: `.topbar`
- Заголовок: `.topbar-title`
- Группа кнопок/ссылок: `.topbar-nav` (+ `.btn`, `.btn.ghost`, `.btn.primary`)

### Основной контейнер
- Обёртка контента: `.main` (контейнер для @container-кверей, автоцентрирование, max-width)

### Блоки/секции
- Отступы секции: `.section`
- Заголовок секции: `.section-title`

### Кнопки/кнопочные группы
- Базовая кнопка: `.btn`
- Варианты: `.primary`, `.ghost`, `.btn-danger`, `.full`
- Группа: `.btn-group`
- Иконка внутри: `.btn-icon`
- Расширение тач-цели мини‑кнопки: `.tap-area`

### Формы
- Текстовые поля/селекты/textarea: `.input` (или оставить `input`, стили применятся по селекторам)
- Валидация: `.is-invalid` на контрол; пояснение: `.help-text`

### Карточки
- Карточка: `.card`
- Заголовок: `.card-title`
- Действия: `.card-actions`

### Календарь/сетка
- Контейнер недель: `.week-grid`
- Сетка календаря: `.calendar-grid`
- Ячейка: `.cell` + модификаторы `.is-head`, `.is-outside-month`, `.is-today`, `.is-selected`
- Поддерживаются ARIA/атрибуты: `[aria-selected="true"]`, `[data-selected="true"]`

### Модалка
- Диалоговая область: `.modal[open]`
- Подложка: `.modal-backdrop`
- Карточка: `.modal-card`
- Кнопка закрытия: `.modal-close`
- Нижняя панель действий: `.form-actions` (sticky, safe-area)

---

## 3) Адаптивность и квери

- **Mobile-first**: базовая стилистика на узких экранах.
- **Container Queries** в `.main`:
  - `@container (min-width: 40rem)` → `.week-grid` в 2 колонки
  - `@container (min-width: 64rem)` → `.week-grid` в 3 колонки
  - `.stat-box` масштабируются на 30/48rem
- **Viewport fallback** остался (`@media (min-width: 720/1024px)`), если CQ не поддерживаются.

---

## 4) Безопасность макета и UX

- **Safe Areas**: учтены `env(safe-area-inset-*)` у `body`, `.topbar`, `.footer`.
- **Типографика**: всё в `rem`; заголовки через `clamp()`.
- **Тач‑цели**: минимум 44px по высоте.
- **Фокус**: используем `:focus-visible`, не отключаем outline.
- **CLS**: для медиа — утилиты `.media`, `.media-16x9/4x3/1x1`.
- **Перфоманс**: `content-visibility` для `.vlist`/`.virtual-section`, `scrollbar-gutter: stable`.

---

## 5) Чек‑лист ручного тестирования (быстрая регрессия)

Провести на ширинах **360 / 390 / 430 / 480 / 768 px** и в тёмной теме:

- [ ] Нет горизонтальной прокрутки на главных экранах.
- [ ] Тач‑цели ≥ 44px; легко попадать большим пальцем.
- [ ] Фокус‑рамки видимы клавиатурой (Tab) и контрастны.
- [ ] При увеличении системного шрифта на 2 шага верстка не «ползёт».
- [ ] Модалки: длинные формы — кнопки видны (sticky), safe‑area работает.
- [ ] Календарь: различимы «сегодня», «выбрано», «наведение» (на устройствах с hover).

---

## 6) Рекомендации по коду (опционально)

- Критический CSS можно инлайнить в `<head>`, остальное — отложить.  
- Изображения: `loading="lazy" decoding="async"`, `srcset/sizes` по макету.  
- В CSS избегать fixed `height`; использовать `min-height`, `aspect-ratio` и естественный поток.

---

## 7) План дальнейших шагов

1. **Подключить/уточнить** `assets/styles.css` в проде (если не подключен последним — переставить).
2. **Навесить классы** из раздела §2 на существующие элементы там, где это добавляет UX (без изменений JS).
3. **Пробежать чек‑лист §5** на реальных устройствах (iOS/Android).  
4. **Точечный твик** отступов/размеров через токены (править только значения в `:root`).

> Все изменения обратимы и скоплены в одном CSS-файле; DOM/JS не трогаем.


