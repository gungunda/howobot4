# «Лёшин планировщик домашних заданий» — ТЗ на уровне поведения

## 1) Что это за приложение и кому оно нужно

Простое планирование домашки для ученика (8 класс): показать «что делать завтра», позволить отмечать прогресс, редактировать план, делать часть заданий заранее («разгрузка»), и держать данные у пользователя (локально). Главная цель — снизить когнитивную нагрузку «с чего начать» и выровнять нагрузку по неделе.

Ключевые эффекты:

- видно завтрашние задачи и основные метрики (общая нагрузка, выполнено, осталось, ETA/«когда закончу»);
- «разгрузка» позволяет делать часть завтрашних/будущих заданий заранее и тем самым разгружать тяжёлые дни.

## 2) Основные экраны и навигация

В приложении три главных раздела и простая верхняя навигация:

1. **Дашборд** — показывает задачи **на завтра** относительно выбранной даты, 4 метрики и список карточек предметов с планируемым временем выполнения, прогрессом в процентах и кнопками "Редактировать" и  «Закрыть». На карточке есть шаги по прогрессу ±10% в виде кнопок. Редактирование inline формой. После всех предметов кнопка "Добавить", при клике по ней открывается форма для добавления предмета и его длительности в этот конкретный день. После списка регулярных предметов выводится список предметов для разгрузки. Но редактирование их не предусмотрено, кнопки такой  нет.
2. **Расписание** (шаблон недели Пн–Вс) — где редактируются предметы: добавить/удалить, поменять название и плановые минуты, выбрать разгрузочные дни. Выводится в виде списка по дням, одной простыней (понедельник - предметы - кнопка добавить, вторник - предметы - кнопка добавить -...). Редактирование и добавление inline формой (название, время, дни разгрузки).
3. **Календарь** — выбрать дату «D» (кнопка «Сегодня» возвращает к текущей дате). При выборе даты приложение всё равно показывает **план на D+1** в дашборде.

## 3) Модель данных (на уровне смысла)

- **Недельное расписание** (Schedule)— «шаблон» предметов по дням недели с плановыми минутами и настройкой «в какие дни можно разгружать». Это база, от которой отталкиваемся каждый день. В день, предшествующий данному дню недели, этот шаблон будет формировать список предметов для выполнения.
- **Снимок конкретного дня или оверрайд (DayTasks)** — создаётся автоматически, как только пользователь что-то меняет **для этой даты** (правит план/прогресс/закрывает задания). Даже если потом вычистить все задачи, «пустой override» остаётся — это осознанное состояние «в этот день ничего не делаем».
- **Предмет (Task)** - задача которая будет решаться в какой-то день недели или конкретный день с указанием ее длительности, процента выполнения. статуса (closed: false/true)

## 4) Ключевые правила дат и показа

- Пользователь выбирает дату **D** (например, сегодня).
- На **Дашборде** всегда показываются задачи **на D+1** (завтра для выбранной даты). Это снимает вопрос «что делать сегодня, чтобы завтра не завалиться».
- Все записи фактического прогресса «за сегодня» относятся к целевому дню (например, выполняем часть задач пятницы (предмет в субботнем расписании) в понедельник — растёт прогресс **пятничной** задачи). Это и есть «разгрузка»: работа заранее записывается в целевой день.

## 5) Пользовательские действия и что происходит «под капотом» (на уровне логики)

### 5.1 Дашборд (список карточек)

- **Увеличить/уменьшить прогресс на ±10%**  — растёт/падает процент выполнения конкретной задачи завтрашнего дня. Если прогресс достигает 100% — задача становится «Закрыта». Если изменения касаются дня впервые — автоматически создаётся DayTasks  этого дня и туда попадает «клон» задачи из расписания.
- **Закрыть задачу** — ставит статус closed но не меняет процент выполнения, то есть можно закрыть задачу так ее и не выполнив до конца. При подсчете оставшегося времени закрытая задача не будет учитываться независимо от процента выполнения. Результат отражается в метриках «Выполнено/Осталось».
- **Правка названия и планового времени на завтра (точечно)** — изменение названия и минут для задачи на D+1 создаёт/правит \*\*DayTasks \*\*этого дня (шаблон недели при этом не трогаем).

### 5.2 Расписание (шаблон недели)

- **Добавить предмет в конкретный день недели** — появляется новая карточка в шаблоне. На дашборде она будет видна в соответствующие даты.
- **Редактировать предмет** — можно сменить название, плановые минуты, и указать **разгрузочные дни** (чекбоксы по дням недели). Разгрузочные дни **не копируются** в снимки дней — они влияют только на отображение «что можно поделать заранее».
- **Удалить предмет из шаблона недели** — он перестаёт появляться в будущие дни. (Уже созданные ранее **DayTasks**-снимки не меняются задним числом.)

### 5.3 Календарь

- **Выбор даты (D)** — меняет контекст: дашборд покажет план на **D+1**. Кнопка **«Сегодня»** возвращает к текущей дате.

### 5.4 Работа с конкретным днём (DayTasks -логика)

- **Первое изменение по дню** — создаётся DayTasks (с клонами задач из шаблона **только тех**, что нужны на этот день). Далее все правки дня — внутри этого DayTasks.
- **Удалить одну задачу в этом дне** — она исчезает из DayTasks. Сам DayTasks остаётся (даже если стал пустой), потому что «пустой день» — это осознанное состояние.
- **Сбросить день к шаблону** — перегенерировать (клонировать) DayTasks заново из текущего шаблона дня недели.

## 6) Метрики, которые видит пользователь

- **Общая нагрузка** — сумма плановых часов-минут завтрашних задач.
- **Выполнено** —процент выполнения от суммарного задания по всем предметам на завтра.
- **Осталось** — сколько часов и минут ещё не сделано по незакрытым задачам.
- **Финиш** — ориентировочное время завершения,  простая оценка «сейчас + осталось».



## 7) Разгрузка (делаем заранее)

- В расписании у предмета можно отметить, в какие прочие **дни недели** допустимо «делать заранее». Выбор  дня недели предшествующего данному должен быть невозможен (это регулярный день, он и так выведет данный предмет в списке). 
- На дашборде такие «разгружаемые» задачи отображаются после дел «на сегодня» с пометкой, к какому дню они относятся.
- Изменяя прогресс по «разгрузке» сегодня, мы **увеличиваем прогресс целевого разгружаемого дня** (то есть меняем DayTasks дня предшествующего тому, который в расписании, и из которого был взят этот предмет для разгрузки). Так снимается часть нагрузки с тяжёлого дня. То есть если в расписании субботы была Химия и разгрузка отмечена на вторник, то во вторник Химия выведется в списке разгрузки и при изменении прогресса Химии поменяется прогресс Химии в оверрайде Пятницы (регулярный день субботней Химии).

## 8) Жизненный цикл и чистка данных

Чтобы не раздувать локальное хранилище, старые даты (далеко позади «вчера» - по заданному интервалу, например, 7 дней) периодически удаляются/архивируются. Это никак не мешает текущей работе: план строится от шаблона + ближайшие правки.

## 9) Типичные пользовательские маршруты

**Маршрут А. «Быстрый учёбный день»**

1. Открыл приложение → Дашборд показывает завтра.
2. Потыкал «+10%» на двух задачах, одну «Закрыл».
3. Итоги в метриках обновились.

**Маршрут Б. «Подготовился заранее» (разгрузка)**

1. Сегодня понедельник. В расписании у «Математики (суббота)» отмечена разгрузка «Пн».
2. На дашборде вижу «Математика (на сб) — можно сделать часть сегодня».
3. Жму «+10%» → растёт прогресс пятничной задачи; пятница станет легче, разгрузится.

**Маршрут В. «Подправил завтрашний план точечно»**

1. Открыл дашборд на D+1, у «Физики» слишком много минут.
2. Убавил план на 10 минут → создался/обновился DayTasks для этого дня; шаблон недели не тронут.

**Маршрут Г. «Пофиксил шаблон недели»**

1. В «Расписании» добавил «Английский» на среду и убрал «Историю» с пятницы.
2. Будущие дни начнут строиться уже с этим шаблоном. Прошлые оверрайды остаются как были.

**Маршрут Д. «Очистил день полностью»**

1. На дашборде понял, что завтра задач не будет.
2. Нажал «Очистить день» → DayTasks остался пустым (это явное решение «в этот день ничего не делаем»), метрики обнулились.

## 11) Нефункциональные ожидания (с точки зрения пользователя)

- Приложение отзывчиво на телефоне (веб-контекст Telegram), без «зависаний» на простых списках (до \~100 карточек).
- Интерфейс простой: понятные подписи, шаги по 10% для прогресса, лаконичные формы правки.

